---
// BaseLayoutをインポート
import BaseLayout from '../layouts/BaseLayout.astro';

// TOPページ専用コンポーネント
import VideoModal from '../components/VideoModal.astro';
import Hero from '../components/pages/top/Hero.astro';
import Location from '../components/pages/top/Location.astro';
import Activities from '../components/pages/top/Activities.astro';
import Enjoy from '../components/pages/top/Enjoy.astro';
import Hospitality from '../components/pages/top/Hospitality.astro';
import News from '../components/pages/top/News.astro';
import Blog from '../components/pages/top/Blog.astro';
---

<BaseLayout pageTitle="">
  <!-- 動画モーダル（TOPページ専用） -->
  <VideoModal />

  <!-- TOPページのメインコンテンツ -->
  <!-- ヒーローセクション -->
  <Hero />
  <!-- ロケーションセクション -->
  <Location />
  <!-- アクティビティーズセクション -->
  <Activities />
  <!-- エンジョイセクション -->
  <Enjoy />
  <!-- ホスピタリティセクション -->
  <Hospitality />
  <!-- ニュースセクション -->
  <News />
  <!-- ブログセクション -->
  <Blog />
</BaseLayout>

<!-- TOPページ専用JavaScript -->
<script>
  // DOMロード後に実行
  document.addEventListener('DOMContentLoaded', () => {
    // 動画モーダル関連の要素
    const videoModal = document.querySelector(
      '.video-modal'
    ) as HTMLElement | null;
    const videoModalClose = document.querySelector(
      '.video-modal__close'
    ) as HTMLElement | null;
    const heroMovieThumbnail = document.querySelector(
      '.hero__movie-thumbnail'
    ) as HTMLElement | null;
    const heroMoviePlayIcon = document.querySelector(
      '.hero__movie-play-icon'
    ) as HTMLElement | null;
    const heroMoviePlayText = document.querySelector(
      '.hero__movie-play-text'
    ) as HTMLElement | null;
    const videoIframe = document.querySelector(
      '.video-modal iframe'
    ) as HTMLIFrameElement | null;

    // 動画モーダルを開く関数
    function openVideoModal() {
      if (videoModal) {
        videoModal.style.opacity = '1';
        videoModal.style.visibility = 'visible';
        // スクロールを禁止
        document.body.style.overflow = 'hidden';
      }
    }

    // 動画モーダルを閉じる関数
    function closeVideoModal() {
      if (videoModal && videoIframe) {
        videoModal.style.opacity = '0';
        videoModal.style.visibility = 'hidden';
        // 動画を停止（iframe srcを再設定）
        const currentSrc = videoIframe.src;
        videoIframe.src = '';
        videoIframe.src = currentSrc;
        // スクロールを復元
        document.body.style.overflow = '';
      }
    }

    // サムネイルクリックで動画モーダルを開く
    if (heroMovieThumbnail) {
      heroMovieThumbnail.addEventListener('click', openVideoModal);
    }

    // 再生アイコンクリックで動画モーダルを開く
    if (heroMoviePlayIcon) {
      heroMoviePlayIcon.addEventListener('click', openVideoModal);
    }

    // 再生テキストクリックで動画モーダルを開く
    if (heroMoviePlayText) {
      heroMoviePlayText.addEventListener('click', openVideoModal);
    }

    // モーダル閉じるボタン
    if (videoModalClose) {
      videoModalClose.addEventListener('click', closeVideoModal);
    }

    // オーバーレイクリックで閉じる（任意）
    if (videoModal) {
      videoModal.addEventListener('click', (e) => {
        if (
          e.target === videoModal ||
          (e.target as HTMLElement).classList.contains('video-modal__overlay')
        ) {
          closeVideoModal();
        }
      });
    }
  });
</script>
